<?xml version="1.0" encoding="UTF-8"?>
<svg version="1.2" baseProfile="tiny" xml:id="svg-root" width="100%" height="100%"
  viewBox="0 0 480 360" xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xe="http://www.w3.org/2001/xml-events">
  <!--======================================================================-->
  <!--=  Copyright 2008 World Wide Web Consortium, (Massachusetts          =-->
  <!--=  Institute of Technology, European Research Consortium for         =-->
  <!--=  Informatics and Mathematics (ERCIM), Keio University).            =-->
  <!--=  All Rights Reserved.                                              =-->
  <!--=  See http://www.w3.org/Consortium/Legal/.                          =-->
  <!--======================================================================-->
  <SVGTestCase xmlns="http://www.w3.org/2000/02/svg/testsuite/description/"
    reviewer="AE" owner="AN" desc="Tests the interface SVGLocatable" status="created"
    approved="no"
    version="$Revision: 1.3 $" testname="$RCSfile: udom-svglocatable-204-t.svg,v $">
    <d:OperatorScript xmlns:d="http://www.w3.org/2000/02/svg/testsuite/description/" xmlns="http://www.w3.org/1999/xhtml">
      <p>This test checks all the methods and properties of the SVGLocatable interface. The method .getScreenCTM() is tested from the rotated text element, the method .getBBox() is tested between the rotated text and its parent group, the method .getBBox() are tested on the red circle.</p>
      <p>For the test to pass, the values generated by script must match the values provided in the png image. The correct values for a viewport of (0,0,400, 400 )are:</p>
      <p>.getScreenCTM() for id "rotText": 0.35,0.35,-0.35,0.35,58.00,0.00</p>
      <p>.getBBox() for 'redCircle': .x=-50,.y=-50,.width=100,.height=100</p>
      <p>.getScreenBBox() for 'redCircle': .x=141,.y=83,.width=83,.height=83</p>
    </d:OperatorScript>
  </SVGTestCase>
  <title xml:id="test-title">$RCSfile: udom-svglocatable-204-t.svg,v $</title>
  <defs>
    <font-face font-family="SVGFreeSansASCII" unicode-range="U+0-7F">
      <font-face-src>
        <font-face-uri xlink:href="../images/SVGFreeSans.svg#ascii" />
      </font-face-src>
    </font-face>
  </defs>
  <g xml:id="test-body-content" font-family="SVGFreeSansASCII,sans-serif" font-size="18">

    <handler xe:observer="svg-root" xe:event="SVGLoad">
      testSVGLocatable(evt);
    </handler>

    <script type="text/ecmascript">
      <![CDATA[
    function testSVGLocatable() {
      var rotText = document.getElementById("rotatedText");
      var redCircle = document.getElementById("redCircle")
      var matr = rotText.getScreenCTM();
      document.getElementById("result1").textContent = ".getScreenCTM(): " + matr.getComponent(0).toFixed(2) + "," + matr.getComponent(1).toFixed(2) + "," + matr.getComponent(2).toFixed(2) + "," + matr.getComponent(3).toFixed(2) + "," + matr.getComponent(4).toFixed(2) + "," + matr.getComponent(5).toFixed(2);
      var bbox = redCircle.getBBox();
      document.getElementById("result2").textContent = ".getBBox() for 'redCircle': .x="+bbox.x+",.y="+bbox.y+",.width="+bbox.width+",.height="+bbox.height;
      var bbox = redCircle.getScreenBBox();
      document.getElementById("result3").textContent = ".getScreenBBox() for 'redCircle': .x="+bbox.x.toFixed(2)+",.y="+bbox.y.toFixed(2)+",.width="+bbox.width.toFixed(2)+",.height="+bbox.height.toFixed(2);
    }	
  ]]>
    </script>
    <g font-family="sans-serif" font-size="12">
      <g xml:id="parentGroup" transform="translate(70,-60)">
        <text xml:id="rotatedText" transform="scale(0.6),rotate(45)" font-size="20" x="30" y="150">Rotated Text for testing SVGLocatable</text>
        <text xml:id="otherText" transform="scale(0.7)" font-size="20" x="100" y="130">Some other text with id 'otherText'</text>
        <g transform="translate(150, 150)">
          <circle xml:id="redCircle" cx="0" cy="0" r="50" fill="red" />
        </g>
      </g>
      <text xml:id="result1" x="10" y="200"> </text>
      <text xml:id="result2" x="10" y="220"> </text>
      <text xml:id="result3" x="10" y="240"> </text>
    </g>
  </g>
  <g font-family="SVGFreeSansASCII,sans-serif" font-size="32">
    <text xml:id="revision" x="10" y="340" stroke="none"
      fill="black">$Revision: 1.3 $</text>
  </g>
  <rect xml:id="test-frame" x="1" y="1" width="478" height="358" fill="none" stroke="#000"/>
  <!-- comment out this watermark once the test is approved -->
  <g xml:id="draft-watermark">
    <rect x="1" y="1" width="478" height="20" fill="red" stroke="black" stroke-width="1"/>
    <text font-family="SVGFreeSansASCII,sans-serif" font-weight="bold" font-size="20" x="240"
      text-anchor="middle" y="18" stroke-width="0.5" stroke="black" fill="white">DRAFT</text>
  </g>
</svg>
